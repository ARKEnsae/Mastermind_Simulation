\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Mastermind et permutations},
            pdfauthor={Kim Antunez, Romain Lesauvage, Alain Quartier-la-Tente},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
% https://github.com/rstudio/rmarkdown/issues/337
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

% https://github.com/rstudio/rmarkdown/pull/252
\usepackage{titling}
\setlength{\droptitle}{-2em}

\pretitle{\vspace{\droptitle}\centering\huge}
\posttitle{\par}

\preauthor{\centering\large\emph}
\postauthor{\par}

\predate{\centering\large\emph}
\postdate{\par}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

\title{Mastermind et permutations}
\author{Kim Antunez, Romain Lesauvage, Alain Quartier-la-Tente}
\date{27 mars 2020}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(cars)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rm}\NormalTok{(}\DataTypeTok{list=}\KeywordTok{ls}\NormalTok{())}
\KeywordTok{library}\NormalTok{(plot3D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'plot3D' was built under R version 3.6.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(shinyWidgets)}
\KeywordTok{library}\NormalTok{(kableExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'kableExtra' was built under R version 3.6.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(shinyjs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'shinyjs' was built under R version 3.6.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'shinyjs'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:methods':
## 
##     removeClass, show
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{#################################################################}
\NormalTok{##################### ParamÃ¨tres du globaux  #####################}
\NormalTok{#################################################################}

\CommentTok{#m = 6 #j (couleur)}
\CommentTok{#n = 4 #i (bille)}
\CommentTok{#N = 100}
\CommentTok{#rho = 0.1 }
\CommentTok{#maxIters=100}
\CommentTok{#poids_noir = 2}
\CommentTok{#poids_blanc = 1}
\CommentTok{#smoothing = TRUE}
\CommentTok{#alpha = 0.7}

\KeywordTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{) }\CommentTok{# la seed}

\NormalTok{colors <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"#0000FF"}\NormalTok{,}\StringTok{"#00FF00"}\NormalTok{,}\StringTok{"#FF3232"}\NormalTok{,}\StringTok{"#FFFF00"}\NormalTok{,}\StringTok{"#CF00CF"}\NormalTok{,}\StringTok{"#FFCFFF"}\NormalTok{,}\StringTok{"#00FFFF"}\NormalTok{,}\StringTok{"#008F00"}\NormalTok{,}\StringTok{"#FF4F4F"}\NormalTok{,}\StringTok{"#000000"}\NormalTok{) }\CommentTok{# 10 couleurs max}

\NormalTok{C =}\StringTok{ }\DecValTok{5} \CommentTok{#non paramÃ©trable dans shiny}

\NormalTok{#################################################################}
\NormalTok{########################## Fonctions  ###########################}
\NormalTok{#################################################################}

\CommentTok{# CrÃ©ation du vecteur y }
\NormalTok{initialiser_y <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(m,n)\{}
\NormalTok{  y <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{m, n, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{)}
  \KeywordTok{return}\NormalTok{(y)}
\NormalTok{\}}

\NormalTok{nb_fiches_noires <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, y)\{}
  \KeywordTok{sum}\NormalTok{(x }\OperatorTok{==}\StringTok{ }\NormalTok{y)}
\NormalTok{\}}

\NormalTok{nb_fiches_blanches <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, y)\{}
  \CommentTok{# On enlÃ¨ve les bien placÃ©s}
\NormalTok{  sous_x <-}\StringTok{ }\NormalTok{x[x }\OperatorTok{!=}\StringTok{ }\NormalTok{y]}
\NormalTok{  sous_y <-}\StringTok{ }\NormalTok{y[x }\OperatorTok{!=}\StringTok{ }\NormalTok{y]}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(sous_x) }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{)}
    \KeywordTok{return}\NormalTok{(}\DecValTok{0}\NormalTok{)}
  \CommentTok{# Pour chaque couleur de sous_x, on regarde si elle est dans y }
\NormalTok{  mal_places <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(sous_x, }\ControlFlowTok{function}\NormalTok{(x)\{}
    \KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(x,sous_y))}\OperatorTok{>}\DecValTok{0}
\NormalTok{  \})}
  \KeywordTok{sum}\NormalTok{(mal_places)}
\NormalTok{\}}

\NormalTok{score <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, y,}\DataTypeTok{poids_noir=}\DecValTok{2}\NormalTok{,}\DataTypeTok{poids_blanc=}\DecValTok{1}\NormalTok{,}\DataTypeTok{normalisation=}\OtherTok{TRUE}\NormalTok{)\{}
\NormalTok{  score =}\StringTok{ }\NormalTok{poids_noir}\OperatorTok{*}\StringTok{ }\KeywordTok{nb_fiches_noires}\NormalTok{(x,y) }\OperatorTok{*}\StringTok{ }\NormalTok{poids_blanc }\OperatorTok{+}\StringTok{ }\KeywordTok{nb_fiches_blanches}\NormalTok{(x,y)}
  \ControlFlowTok{if}\NormalTok{(normalisation)\{}
\NormalTok{    score =}\StringTok{ }\NormalTok{score }\OperatorTok{/}\StringTok{ }\NormalTok{(poids_noir}\OperatorTok{*}\KeywordTok{length}\NormalTok{(x))   }
\NormalTok{  \}}
    \KeywordTok{return}\NormalTok{(score)}
\NormalTok{\}}
\CommentTok{#score(X[2,],y)}

\NormalTok{#################################################################}
\NormalTok{###################### Etape d'initialisation ###################}
\NormalTok{#################################################################}

\CommentTok{# CrÃ©ation du vecteur y }
\CommentTok{#y <- initialiser_y(m,n)}


\NormalTok{lancer_algorithme <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(y, n, m, }\DataTypeTok{N =}\NormalTok{ C}\OperatorTok{*}\NormalTok{m}\OperatorTok{*}\NormalTok{n, }\DataTypeTok{maxIters =} \DecValTok{100}\NormalTok{,}
                              \DataTypeTok{rho =} \FloatTok{0.1}\NormalTok{, }\DataTypeTok{alpha =} \FloatTok{0.7}\NormalTok{,}
                              \DataTypeTok{poids_blanc =} \DecValTok{1}\NormalTok{, }\DataTypeTok{poids_noir =} \DecValTok{2}\NormalTok{,}
                              \DataTypeTok{smoothing =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{C=}\DecValTok{5}\NormalTok{, }\DataTypeTok{d=}\DecValTok{5}\NormalTok{, }\DataTypeTok{stop_d=}\OtherTok{FALSE}\NormalTok{)\{}
  
\NormalTok{  duree =}\StringTok{ }\KeywordTok{Sys.time}\NormalTok{()}
  
  \CommentTok{# Creation des N vecteurs X  : Matrice X (Nxm)}
\NormalTok{  X <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{m, N, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{),N),}
              \DataTypeTok{nrow =}\NormalTok{ N, }\DataTypeTok{ncol =}\NormalTok{ n, }\DataTypeTok{byrow=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{  X}
  
  \CommentTok{# CrÃ©ation de la matrice P_hat initiale (n x m) }
\NormalTok{  P_hat_tilde <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ m)}
\NormalTok{  P_hat_liste <-}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{  P_hat_liste[[}\DecValTok{1}\NormalTok{]] <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{1}\OperatorTok{/}\NormalTok{m,}\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ m) }\CommentTok{# initialisation}
  
  \CommentTok{# Listes Ã  agrÃ©menter}
  \CommentTok{#meilleur_score = 0}
  \CommentTok{#meilleur_scores = c()}
\NormalTok{  gammas_hat =}\StringTok{ }\KeywordTok{c}\NormalTok{()}
\NormalTok{  s_max =}\StringTok{ }\KeywordTok{c}\NormalTok{()}
\NormalTok{  indice_stop =}\StringTok{ }\OtherTok{NULL}
  
\NormalTok{  ###### Algo}
  
  
  
\NormalTok{  #### dÃ©but du try}
  
  \KeywordTok{try}\NormalTok{(\{}
    
    \ControlFlowTok{for}\NormalTok{(iter }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\NormalTok{maxIters)\{}
      
      \ControlFlowTok{if}\NormalTok{(iter}\OperatorTok{>}\DecValTok{2}\NormalTok{)\{}
\NormalTok{        ### Calcul des nouveau X > Ã  dÃ©placer Ã  la fin de l'algo ?}
        \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{n)\{}
\NormalTok{          X[,i] <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{m, N, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{prob=}\NormalTok{P_hat[i,])}
\NormalTok{        \}}
\NormalTok{      \}}
      
\NormalTok{      #### Calcul du score}
      
\NormalTok{      scores <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(X,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(ligne)\{}\KeywordTok{score}\NormalTok{(ligne,}\DataTypeTok{y=}\NormalTok{y,}\DataTypeTok{poids_noir =}\NormalTok{ poids_noir,}\DataTypeTok{poids_blanc=}\NormalTok{poids_blanc)\})}
      
\NormalTok{      scores_tries <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(scores)}
      
      \CommentTok{# Mise Ã  jour de Gamma }
      \CommentTok{#ceils = rounds each element of X to the nearest integer greater than or equal to that element.}
\NormalTok{      eidx =}\StringTok{ }\KeywordTok{ceiling}\NormalTok{((}\DecValTok{1}\OperatorTok{-}\NormalTok{rho)}\OperatorTok{*}\NormalTok{N) }\CommentTok{#plus petit indice du meilleur Score.}
\NormalTok{      gamma =}\StringTok{ }\NormalTok{scores_tries[eidx]}
\NormalTok{      s =}\StringTok{ }\NormalTok{scores_tries[N]}
      \CommentTok{#  meilleur_score = max(meilleur_score,  scores_tries[N]) #garder une trace du meilleur rÃ©sultat}
\NormalTok{      gammas_hat[iter] =}\StringTok{ }\NormalTok{gamma}
\NormalTok{      s_max[iter] =}\StringTok{ }\NormalTok{s}
      \CommentTok{# meilleur_scores[iter] = meilleur_score}
      
      
      \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{n)\{}
        \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{m)\{}
\NormalTok{          P_hat_tilde[i,j]=}\KeywordTok{sum}\NormalTok{(scores}\OperatorTok{>=}\NormalTok{gamma }\OperatorTok{&}\StringTok{ }\NormalTok{X[,i]}\OperatorTok{==}\NormalTok{j)}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(scores}\OperatorTok{>=}\NormalTok{gamma)}
\NormalTok{        \}}
\NormalTok{      \}}
      
      \CommentTok{# Smoothing}
      \ControlFlowTok{if}\NormalTok{(smoothing)\{}
\NormalTok{        P_hat <-}\StringTok{ }\NormalTok{alpha }\OperatorTok{*}\StringTok{ }\NormalTok{P_hat_tilde }\OperatorTok{+}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{alpha)}\OperatorTok{*}\StringTok{ }\NormalTok{P_hat_liste[[iter}\DecValTok{-1}\NormalTok{]]}
\NormalTok{      \} }\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{        P_hat <-}\StringTok{ }\NormalTok{P_hat_tilde}
\NormalTok{      \}}
      
\NormalTok{      P_hat_liste[[iter]] <-}\StringTok{ }\NormalTok{P_hat}
      
      \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(gammas_hat)}\OperatorTok{>}\NormalTok{d }\OperatorTok{&}\StringTok{ }\KeywordTok{is.null}\NormalTok{(indice_stop))\{}
\NormalTok{        gammas_d <-}\StringTok{ }\NormalTok{gammas_hat[(}\KeywordTok{length}\NormalTok{(gammas_hat)}\OperatorTok{-}\NormalTok{d)}\OperatorTok{:}\KeywordTok{length}\NormalTok{(gammas_hat)]}
        \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{unique}\NormalTok{(gammas_d))}\OperatorTok{==}\DecValTok{1}\NormalTok{)\{}
\NormalTok{          indice_stop <-}\StringTok{ }\NormalTok{iter}
          \ControlFlowTok{if}\NormalTok{(stop_d)\{}
            \KeywordTok{stop}\NormalTok{(}\StringTok{"DerniÃ¨re itÃ©ration : "}\NormalTok{,indice_stop)  }
\NormalTok{          \}}
\NormalTok{        \}}
\NormalTok{      \}}
      
\NormalTok{    \}}
    
    
\NormalTok{  \})}
\NormalTok{  ### fin de try}
  
\NormalTok{  duree <-}\StringTok{ }\KeywordTok{round}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{difftime}\NormalTok{(}\KeywordTok{Sys.time}\NormalTok{(), duree),}\DataTypeTok{units=}\StringTok{"secs"}\NormalTok{),}\DecValTok{2}\NormalTok{)}
  
  
  \KeywordTok{return}\NormalTok{(}
    \KeywordTok{list}\NormalTok{(}
      \DataTypeTok{duree =}\NormalTok{ duree,}
      \DataTypeTok{parametres=}\KeywordTok{list}\NormalTok{(}
        \DataTypeTok{n=}\NormalTok{n,}
        \DataTypeTok{m=}\NormalTok{m,}
        \DataTypeTok{N=}\NormalTok{N,}
        \DataTypeTok{maxIters=}\NormalTok{ maxIters,}
        \DataTypeTok{rho =}\NormalTok{ rho,}
        \DataTypeTok{alpha =}\NormalTok{ alpha,}
        \DataTypeTok{smoothing =}\NormalTok{ smoothing,}
        \DataTypeTok{d=}\NormalTok{d}
        
\NormalTok{      ),}
      
      
      \DataTypeTok{P_hat_liste=}\NormalTok{P_hat_liste,}
      \DataTypeTok{s_max=}\NormalTok{s_max,}
      \DataTypeTok{gammas_hat=}\NormalTok{gammas_hat,}
      \DataTypeTok{indice_stop=}\NormalTok{indice_stop}
\NormalTok{    )}
  
\NormalTok{  )}

  
\NormalTok{\}}

\CommentTok{#m=7}
\CommentTok{#n=4}
\CommentTok{#modele <- lancer_algorithme(y=sample(1:m, n, replace = TRUE), n=n, m=m,maxIters=100,N=m*n*5,stop_d=TRUE)}


\CommentTok{#matrice : n lignes (i) m colonnes (j)}

\NormalTok{p_min_max <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(matrice)\{}
\NormalTok{  max_min <-}\StringTok{ }\KeywordTok{max}\NormalTok{(}\KeywordTok{apply}\NormalTok{(matrice,}\DecValTok{1}\NormalTok{,min))}
\NormalTok{  min_max <-}\StringTok{ }\KeywordTok{min}\NormalTok{(}\KeywordTok{apply}\NormalTok{(matrice,}\DecValTok{1}\NormalTok{,max))}
\NormalTok{  min <-}\StringTok{ }\KeywordTok{min}\NormalTok{(matrice)}
\NormalTok{  max <-}\StringTok{ }\KeywordTok{max}\NormalTok{(matrice)}
  
  \KeywordTok{return}\NormalTok{(}\KeywordTok{list}\NormalTok{(}\DataTypeTok{min =}\NormalTok{ min,}
              \DataTypeTok{max =}\NormalTok{ max,}
              \DataTypeTok{min_max =}\NormalTok{ min_max,}
              \DataTypeTok{max_min =}\NormalTok{ max_min))}
\NormalTok{\}}



\NormalTok{matrice_to_proposition <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(matrice)\{}
  
\NormalTok{  matrice_ordre <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(matrice,}\DecValTok{1}\NormalTok{,rank)  }
  \KeywordTok{return}\NormalTok{(}\KeywordTok{apply}\NormalTok{(matrice_ordre,}\DecValTok{2}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(x)\{}\KeywordTok{which}\NormalTok{(x}\OperatorTok{==}\KeywordTok{max}\NormalTok{(x))\})) }
\NormalTok{\}}
\CommentTok{#matrice_to_proposition(modele$P_hat_liste[[100]])}

\NormalTok{### Dessiner histogramme}

\NormalTok{dessiner_histo <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(liste_matrice,indice,colors)\{}
\NormalTok{  matrice=liste_matrice[[indice]]}
\NormalTok{  n =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(matrice))}
\NormalTok{  m =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(matrice))}
\NormalTok{  couleurs_graphe <-}\StringTok{ }\KeywordTok{t}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(m),}\KeywordTok{length}\NormalTok{(n)),}\DataTypeTok{nrow=}\KeywordTok{length}\NormalTok{(n),}\DataTypeTok{ncol=}\KeywordTok{length}\NormalTok{(m),}\DataTypeTok{byrow=}\OtherTok{TRUE}\NormalTok{))}
  
  \KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{))}
  \KeywordTok{hist3D}\NormalTok{(m, n, }\KeywordTok{t}\NormalTok{(matrice), }\DataTypeTok{zlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{colvar =}\NormalTok{ couleurs_graphe,}
         \DataTypeTok{col =}\NormalTok{ colors[}\DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(matrice)],}\DataTypeTok{theta=}\DecValTok{50}\NormalTok{, }\DataTypeTok{phi=}\DecValTok{40}\NormalTok{, }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{label=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{ticktype=}\StringTok{"detailed"}\NormalTok{, }\DataTypeTok{space=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{lighting=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{light=}\StringTok{"diffuse"}\NormalTok{, }\DataTypeTok{shade=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.6}\NormalTok{, }\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{"billes"}\NormalTok{,}\DataTypeTok{zlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{colkey=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{plot=}\OtherTok{FALSE}\NormalTok{))}
  
\NormalTok{\}}

\NormalTok{tableau_bilan <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(modele)\{}
  
  \ControlFlowTok{if}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.null}\NormalTok{(modele}\OperatorTok{$}\NormalTok{indice_stop))\{}
\NormalTok{    i <-}\StringTok{ }\NormalTok{modele}\OperatorTok{$}\NormalTok{indice_stop}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{    i <-}\StringTok{ }\NormalTok{modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{N}
\NormalTok{  \}}

  
\NormalTok{  tableau <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
    \DataTypeTok{t =} \DecValTok{1}\OperatorTok{:}\NormalTok{i,}
    \DataTypeTok{s_max =} \KeywordTok{round}\NormalTok{(modele}\OperatorTok{$}\NormalTok{s_max[}\DecValTok{1}\OperatorTok{:}\NormalTok{i],}\DecValTok{3}\NormalTok{),}
    \DataTypeTok{gammas_hat =} \KeywordTok{round}\NormalTok{(modele}\OperatorTok{$}\NormalTok{gammas_hat[}\DecValTok{1}\OperatorTok{:}\NormalTok{i],}\DecValTok{3}\NormalTok{),}
    \DataTypeTok{min =} \KeywordTok{round}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(modele}\OperatorTok{$}\NormalTok{P_hat_liste,p_min_max)[}\StringTok{"min"}\NormalTok{,}\DecValTok{1}\OperatorTok{:}\NormalTok{i]),}\DecValTok{4}\NormalTok{),}
    \DataTypeTok{max_min =}\KeywordTok{round}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(modele}\OperatorTok{$}\NormalTok{P_hat_liste,p_min_max)[}\StringTok{"max_min"}\NormalTok{,}\DecValTok{1}\OperatorTok{:}\NormalTok{i]),}\DecValTok{4}\NormalTok{),}
    \DataTypeTok{min_max =}\KeywordTok{round}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(modele}\OperatorTok{$}\NormalTok{P_hat_liste,p_min_max)[}\StringTok{"min_max"}\NormalTok{,}\DecValTok{1}\OperatorTok{:}\NormalTok{i]),}\DecValTok{4}\NormalTok{),}
    \DataTypeTok{max =} \KeywordTok{round}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(modele}\OperatorTok{$}\NormalTok{P_hat_liste,p_min_max)[}\StringTok{"max"}\NormalTok{,}\DecValTok{1}\OperatorTok{:}\NormalTok{i]),}\DecValTok{4}\NormalTok{)}
    
    
\NormalTok{  )}
   
  
  \KeywordTok{return}\NormalTok{(tableau)}
  
\NormalTok{\}}

\CommentTok{#tab <- tableau_bilan(modele)}

\NormalTok{mise_en_forme_tableau <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(modele)\{}
  
\NormalTok{  tableau <-}\StringTok{ }\KeywordTok{tableau_bilan}\NormalTok{(modele)}
  
\NormalTok{  parametres <-}\StringTok{ }\KeywordTok{paste0}\NormalTok{(}\CommentTok{#" : ",}
                       \StringTok{"n = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{n, }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"m = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{m, }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"N = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{N, }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"rho = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{rho, }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"alpha = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{alpha, }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"smoothing = "}\NormalTok{, }\KeywordTok{ifelse}\NormalTok{(modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{smoothing,}\StringTok{"oui"}\NormalTok{,}\StringTok{"non"}\NormalTok{), }\StringTok{" / "}\NormalTok{,}
                       \StringTok{"d = "}\NormalTok{, modele}\OperatorTok{$}\NormalTok{parametres}\OperatorTok{$}\NormalTok{d}
\NormalTok{  )}
  
\NormalTok{  tableau_joli <-}\StringTok{ }\KeywordTok{kable}\NormalTok{(tableau, }\DataTypeTok{align =} \StringTok{"c"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{kable_styling}\NormalTok{(}\DataTypeTok{full_width =}\NormalTok{ F) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{footnote}\NormalTok{(}\DataTypeTok{general =}\NormalTok{ parametres,}
             \DataTypeTok{general_title =} \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{Parametres"}\NormalTok{,}
             \DataTypeTok{title_format =} \KeywordTok{c}\NormalTok{(}\StringTok{"italic"}\NormalTok{, }\StringTok{"underline"}\NormalTok{)}
\NormalTok{    )}
\NormalTok{  tableau_joli <-}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{'}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{bNA}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{b'}\NormalTok{, }\StringTok{'  '}\NormalTok{, tableau_joli) }\CommentTok{#remove NA}
  
  \KeywordTok{return}\NormalTok{(tableau_joli)}
  
\NormalTok{\}}


\CommentTok{#tab_joli <- mise_en_forme_tableau(tab, modele)}



\NormalTok{#################################################################}
\NormalTok{###################### Affichage des billes #####################}
\NormalTok{#################################################################}

\CommentTok{#https://www.html5canvastutorials.com/tutorials/html5-canvas-circles/}
  
\NormalTok{canvas_width <-}\StringTok{ }\DecValTok{25}
\NormalTok{canvas_height <-}\StringTok{ }\DecValTok{25}

\CommentTok{# radio buttons pour les boules}
\NormalTok{guesscell1 <-}\StringTok{ 'guesscell1'}
\NormalTok{guesscell2 <-}\StringTok{ 'guesscell2'}
\NormalTok{guesscell3 <-}\StringTok{ 'guesscell3'}
\NormalTok{guesscell4 <-}\StringTok{ 'guesscell4'}
\NormalTok{guesscell5 <-}\StringTok{ 'guesscell5'}
\NormalTok{guesscell6 <-}\StringTok{ 'guesscell6'}

\NormalTok{itercell1 <-}\StringTok{ 'itercell1'}
\NormalTok{itercell2 <-}\StringTok{ 'itercell2'}
\NormalTok{itercell3 <-}\StringTok{ 'itercell3'}
\NormalTok{itercell4 <-}\StringTok{ 'itercell4'}
\NormalTok{itercell5 <-}\StringTok{ 'itercell5'}
\NormalTok{itercell6 <-}\StringTok{ 'itercell6'}

\NormalTok{jsDrawCircle <-}
\StringTok{  "shinyjs.drawCircle = function(args)\{var id = args[0]; var code_color = args[1]; console.log(id); var canvas = document.getElementById(id); console.log(canvas); var ctx = canvas.getContext('2d'); ctx.beginPath(); ctx.arc(10, 10, 10, 0, Math.PI * 2, true); ctx.fillStyle = code_color; ctx.fill(); ctx.closePath(); ctx.stroke();\}"}


\NormalTok{jsClearCircle <-}
\StringTok{  "shinyjs.clearCircle = function(args)\{var id = args[0]; console.log(id); var canvas = document.getElementById(id); var ctx = canvas.getContext('2d'); ctx.beginPath(); ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.closePath(); ctx.stroke();\}"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m =}\StringTok{ }\DecValTok{5}
\NormalTok{n =}\StringTok{ }\DecValTok{4}
\NormalTok{modele <-}\StringTok{ }\KeywordTok{lancer_algorithme}\NormalTok{(}\DataTypeTok{y=}\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{m, n, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{), }\DataTypeTok{n=}\NormalTok{n, }\DataTypeTok{m=}\NormalTok{m,}\DataTypeTok{maxIters=}\DecValTok{100}\NormalTok{,}\DataTypeTok{N=}\NormalTok{m}\OperatorTok{*}\NormalTok{n}\OperatorTok{*}\DecValTok{5}\NormalTok{,}\DataTypeTok{stop_d=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in try({ : DerniÃ¨re itÃ©ration : 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tableau <-}\StringTok{ }\KeywordTok{mise_en_forme_tableau}\NormalTok{(modele)}
\NormalTok{tableau}
\end{Highlighting}
\end{Shaded}

\begin{table}[H]
\centering
\begin{tabular}{c|c|c|c|c|c|c}
\hline
t & s\_max & gammas\_hat & min & max\_min & min\_max & max\\
\hline
1 &    &    & 0.2000 & 0.2000 & 0.2000 & 0.2000\\
\hline
2 & 0.75 & 0.625 & 0.0600 & 0.0600 & 0.5267 & 0.7600\\
\hline
3 & 1.00 & 0.750 & 0.0180 & 0.0530 & 0.4730 & 0.8930\\
\hline
4 & 1.00 & 1.000 & 0.0054 & 0.0159 & 0.8419 & 0.9679\\
\hline
5 & 1.00 & 1.000 & 0.0016 & 0.0048 & 0.9526 & 0.9904\\
\hline
6 & 1.00 & 1.000 & 0.0005 & 0.0014 & 0.9858 & 0.9971\\
\hline
7 & 1.00 & 1.000 & 0.0001 & 0.0004 & 0.9957 & 0.9991\\
\hline
8 & 1.00 & 1.000 & 0.0000 & 0.0001 & 0.9987 & 0.9997\\
\hline
9 & 1.00 & 1.000 & 0.0000 & 0.0000 & 0.9996 & 0.9999\\
\hline
\multicolumn{7}{l}{\underline{\textit{makecell[l]{\Parametres}}}}\\
\multicolumn{7}{l}{n = 4 / m = 5 / N = 100 / rho = 0.1 / alpha = 0.7 / smoothing = oui / d = 5}\\
\end{tabular}
\end{table}

\hypertarget{including-plots}{%
\subsection{Including Plots}\label{including-plots}}

You can also embed plots, for example:

\end{document}
